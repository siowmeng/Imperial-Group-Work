---
title: "Maths & Stats Group Project"
author: "Siow Meng Low"
date: "26 September 2016"
output: pdf_document
---

## Loading Data & Key Summary

The first step before any analysis is to load the data. The Kaggle movie data is recorded in the form of a CSV file. We shall first load it and display the key metadata of the data set.

```{r, echo=TRUE}

library(plyr)

movieDF <- read.csv("D:/R/MathsProject/movie_metadata.csv", header = TRUE, stringsAsFactors = FALSE)

names(movieDF)
dim(movieDF)
str(movieDF)
summary(movieDF)

head(movieDF)

#movieDF[movieDF$director_name == "James Cameron", ]
#movieDF[movieDF$actor_1_name == "Johnny Depp", ]

```

As usual, the dataset comes with some missing values. The following R code gives an overview on how many missing values are there per column.

```{r, echo=TRUE}

colNA <- function(dfCol){ sum(is.na(dfCol)) }

apply(movieDF, 2, colNA)

```

## Univariate Statistics

The key variable which we are interested in predicting will be the gross revenue. First let's look at the univariate statistics of this data.

```{r, echo=TRUE}

mean(movieDF$gross, na.rm = TRUE)
var(movieDF$gross, na.rm = TRUE)

```

## Bivariate Statistics

In this section, let us inspect how gross revenue correlates with other columns in the dataset. As seen below, most of the variables have very low correlation coefficient with gross revenue.

```{r, echo=TRUE}

boolGross <- !is.na(movieDF$gross)
boolBudget <- !is.na(movieDF$budget)

bool <- boolGross & boolBudget

# Covariance and correlation of gross revenue with movie budget
cov(movieDF$gross[bool], movieDF$budget[bool])
cor(movieDF$gross[bool], movieDF$budget[bool])

boolDuration <- !is.na(movieDF$duration)

bool <- boolDuration & boolBudget

# Covariance and correlation of movie duration with movie budget
cov(movieDF$duration[bool], movieDF$budget[bool])
cor(movieDF$duration[bool], movieDF$budget[bool])

boolScore <- !is.na(movieDF$imdb_score)

bool <- boolGross & boolScore

# Covariance and correlation of gross revenue with IMDB score
cov(movieDF$gross[bool], movieDF$imdb_score[bool])
cor(movieDF$gross[bool], movieDF$imdb_score[bool])

boolDirFB <- !is.na(movieDF$director_facebook_likes) & (movieDF$director_facebook_likes > 0)

bool <- boolGross & boolDirFB

# Covariance and correlation of gross revenue with Director facebook likes
cov(movieDF$gross[bool], movieDF$director_facebook_likes[bool])
cor(movieDF$gross[bool], movieDF$director_facebook_likes[bool])

boolCastFB <- !is.na(movieDF$cast_total_facebook_likes) & (movieDF$cast_total_facebook_likes > 0)

bool <- boolGross & boolCastFB

# Covariance and correlation of gross revenue with movie cast facebook likes
cov(movieDF$gross[bool], movieDF$cast_total_facebook_likes[bool])
cor(movieDF$gross[bool], movieDF$cast_total_facebook_likes[bool])
```

Next, we'll inspect the total number of likes that the movie gathered on facebook. If we use all the data to calculate correlation, the correlation coefficient is pretty low (< 0.4).

Considering the fact that Facebook was only launched to public in early 2004, it might makes more sense if we only consider the movies made after 2004. The below R code calculate the coefficient for movie produced after 2005 and 2010.

We can see that there's a huge improvement in the correlation. Hence, the total number of facebook likes might be a good predictor for gross revenue.

```{r, echo=TRUE}

boolMovieFB <- !is.na(movieDF$movie_facebook_likes)

bool <- boolGross & boolMovieFB

cov(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])
cor(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])

boolYear <- (!is.na(movieDF$title_year) & movieDF$title_year >= 2005)

bool <- bool & boolYear

cov(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])
cor(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])

boolYear <- (!is.na(movieDF$title_year) & movieDF$title_year >= 2010)

bool <- boolGross & boolMovieFB & boolYear

cov(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])
cor(movieDF$gross[bool], movieDF$movie_facebook_likes[bool])

```

## Multiple Grouping

This section looks at the average gross revenue for different groups of movies. The following code separates the data into different groups: coloured, production year, and language.

```{r, echo=TRUE}

ddply(movieDF, ~ color, summarise, mean = mean(gross, na.rm = TRUE), sd = sd(gross, na.rm = TRUE))
ddply(movieDF, ~ title_year, summarise, mean = mean(gross, na.rm = TRUE), sd = sd(gross, na.rm = TRUE))
ddply(movieDF, ~ language, summarise, mean = mean(gross, na.rm = TRUE), sd = sd(gross, na.rm = TRUE))
ddply(movieDF, ~ title_year + language, summarise, mean = mean(gross, na.rm = TRUE), sd = sd(gross, na.rm = TRUE))

```



